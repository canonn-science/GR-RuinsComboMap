
<!DOCTYPE html>
<html>
<head>

	<title>Guardian Ancient Ruins</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

	<link rel="stylesheet" href="ruins.css" />

	<script src="scripts/jquery-3.1.1.min.js"></script>
	<script src="scripts/jquery.panzoom.js"></script>
	<script src="scripts/guardian.ruins.js"></script>
</head>

<body>
	<div id="main">
		<section id="systems">
			<div id="system_heading">
				<h1>Guardian Ancient Ruins</h1>
				<div id="return_to_map">
					<div>Return to Map</div>
				</div>

			</div>
			<label for="ruin-filter" value="Filter">
				Filter Systems: <input type="text" name="ruin-filter" id="ruin-filter" autofocus >
			</label>
			<table id="ruin-list">
				<tr>
					<th width="20%">System/Body</th>
					<th>Ruin</th>
					<th>Type</th>
					<th>Coordinates</th>
				</tr>
			</table>
		</section>

	    <section id="map" style="display:none">
	    	<div id="map_heading">
	    		<h1>System | Body | Coords (Type)</h1>
	    	</div>

	    	<div class="parent">
				<div class="panzoom noselect" id="ruin-map">
					&nbsp;
				</div>
			</div>


			<div id="mapcontrols" class="noselect">
				<div id="return_to_systems">
					<div>Select Ruin</div>
				</div>

				<div id="zoom-in" class="button first" title="Zoom In">&nbsp;</div>

				<div id="zoom-out" class="button" title="Zoom Out">&nbsp;</div>

				<div id="zoom-reset" class="button" title="Reset Zoom">&nbsp;</div>

				<div id="test-groups" style="background-color: white; display:none">

				</div>
			</div>


			<div id="info" class="down">
				<h2 id="info_bar">
					<span class="chevron">&#x25B4</span> Information <span class="chevron">&#x25B4</span>
				</h2>
				<div class="panel">
					<div class="panel-section">
						<h3>Scans</h3>
						<table id="scan-list">
							<tr>
								<th>Group/Obelisk</th>
								<th>Item 1</th>
								<th>Item 2</th>
								<th>Result</th>
							</tr>
						</table>
					</div>

					<div class="panel-section">
						<h3>Contact information</h3>

						<div>
							<p>You can easily contact the Canonn R&amp;D team on the Canonn Science <a href="http://canonn.science/codex/resource/discord/" target="new">Discord chat</a>. We are happy to help you with any questions regarding this application. Ask for one of the R&amp;D team members.</p>

							<p>If you need technical help with this application, find a bug or have a feature request, feel free to create an issue on our <a href="https://github.com/canonn-science/RuinsComboMap/issues" target="new">GitHub</a> page.</p>

							<p>
							The team members are (in alphabetical order):
								<ul>
									<li>AdmlAdama (Development Interactive Maps)
										<a class="logo elite" href="https://forums.frontier.co.uk/member.php/149570-AdmlAdama" target="new"></a>
										<a class="logo github" href="https://github.com/CmdrAdama" target="new"></a>
									</li>
									<li>DMehaffy (Infrastructure &amp; Hosting)
										<a class="logo elite" href="https://forums.frontier.co.uk/member.php/89809-DMehaffy" target="new"></a>
										<a class="logo github" href="https://github.com/derrickmehaffy" target="new"></a>
									</li>
									<li>Nopileos (Development API Front and Backend)
										<a class="logo elite" href="https://forums.frontier.co.uk/member.php/19716-Phoenix" target="new"></a>
										<a class="logo github" href="https://github.com/sgingter" target="new"></a>
										<a class="logo twitter" href="https://twitter.com/phoenixhawk/" target="new"></a>
									</li>
									<li>Noshei (Science &amp; Data)
										<a class="logo elite" href="https://forums.frontier.co.uk/member.php/73548-Noshei" target="new"></a>
									</li>
									<li>Zebarmy (Science &amp; Data)
										<a class="logo elite" href="https://forums.frontier.co.uk/member.php/18113-Zebarmy" target="new"></a>
										<a class="logo twitter" href="https://twitter.com/zebarmy/" target="new"></a>
									</li>
								</ul>
							</p>
						</div>
					</div>

					<div class="panel-section">
						<h3>Thanks</h3>

						<div>
							<p>We would like to say thank you to masCh who created the <a href="http://nusantara.com.my/EliteDangerous/ruins1.html" target="_blank">first guardian ruins map</a> for the great work and inspiration for this one.</p>
							<p>
								<ul>
									<li>masCh (Developer of the original Guardian Ruins Map)
										<a class="logo elite" href="https://forums.frontier.co.uk/member.php/101551-masCh" target="new"></a>
									</li>
								</ul>
							</p>
						</div>
					</div>





				</div>

			</div>


	    </section>

	<!-- Pop up -->
	<div id="ruin_obelisk_data" style="display:none">
		<div class="obelisk">
			<div>
				Scan Results for <span id="scan_obelisk">Obelisk</span>
			</div>
		</div>

		<div id="scan_data_panel">
			<div class="object" id="scan_object1icon">
				<div class="object1" id="scan_object1">Obelisk 1</div>
			</div>
			<div class="object" id="scan_object2icon">
				<div class="object2" id="scan_object2">Obelisk 2</div>
			</div>
		</div>
		<div id="scan_result_panel">
			<div class="scan" id="scan_result">Scan</div>
		</div>



		<div id="ruin_obelisk_data_close">&nbsp;</div>
	</div>

	<!--
	<div id="ruin_obelisk_data" style="">
		<div class="obelisk">
			<div>
				<span id="scan_obelisk">Obelisk</span> - <span class="scan" id="scan_result">Scan</span>
			</div>
		</div>

		<div id="scan_data_panel">
			<div class="object" id="scan_object1icon">
				<div class="object1" id="scan_object1">Obelisk 1</div>
			</div>
			<div class="object" id="scan_object2icon">
				<div class="object2" id="scan_object2">Obelisk 2</div>
			</div>
		</div>

		<div class="ruin_obelisk_data_close">&nbsp;</div>
	</div>
	-->

	<!-- Notice Panel -->

	<div id="notice" style="display:none">
		Notice Panel
	</div>


	</div>

	      <script>
			window.systems = {};
			window.ruinsIndex = {};
			window.ruinsUI = {
				scanListIndex:'',
				groupBand:'',
				itemBand:''
			}

			window.nav={
				obelisk:'',
				filter:''
			}

			window.ui = {
				enableTesting: false
			}


		  	/* Mapping Mapping Mapping Mapping Mapping Mapping Mapping Mapping Mapping  */
		  	/* Mapping Mapping Mapping Mapping Mapping Mapping Mapping Mapping Mapping  */
		  	/* Mapping Mapping Mapping Mapping Mapping Mapping Mapping Mapping Mapping  */

	      	function prepMapUI(){

			  	window.ruins = Guardian.getRuin({
			  		panzoom:$(".panzoom"),

			  		onMapReady: function(type){

			  			//Clear existing gropus
			        	window.ruins.groups.clearGroups();

			  			//Add those that exist in the current ruin
			  			$.each(window.currentRuin.obelisks,function(group,obeliskData){
			  				window.ruins.groups.addGroup(group,obeliskData);
			  			})

			  			//Hide all groups for the given type
						window.ruins.groups.hideAllForType();

						//Now show those we've added
						window.ruins.groups.showAll();

						//Clear info panel listing
						clearScanList();

						//Disable obelisks that are "broken/inactive" and add scan list items
						$.each(window.currentRuin.obelisks,function(group,obeliskData){
							//Get the scan data for the given group
							var scanData = window.ruins.typeData[window.ruins.ruinData.type][group];

							//Now for those that are inactive... we disable.  Otherwise if there's a scan we add it
							$.each(obeliskData,function(number,data){
								if(0 === data){
									window.ruins.disableObelisk(group,number);
								}else{
									//Have scan data as well?
									if( scanData && scanData[number] ){
										addScanListItem(group, number, scanData[number].items[0], scanData[number].items[1], scanData[number].scan);
										$('#ruin-number-' + group + ' .ruin-number-' + number).css('fill','#00d5ff').css('stroke','#00d5ff');
									}
								}
						    });
						})

						if($.isEmptyObject(window.currentRuin.obelisks)){
							//Update notice
							showNotice('No scan data currently available for this ruin',false);
						}else{
							//Hide notice
			  				hideNotice();
						}


						//Reset the zoom
						window.ruins.zoomReset();

						//And present
			  			showMap();

			  			//Now jump to a nav if applicable
			  			if(window.nav.obelisk.length >= 2){
			  				//Get the group
			  				var group = window.nav.obelisk.substring(0,1);
			  				group = group.toLowerCase();

			  				//Valid group?
			  				if(window.currentRuin.obelisks[group]){
			  					//Yes.  Now the number
			  					var number = parseInt(window.nav.obelisk.substring(1,window.nav.obelisk.length));
			  					if(!isNaN(number)){
									window.ruins.focusOnObelisk(group,number);
			  					}
			  				}

			  				//Get the number
			  			}



						/* Map Testing only */
						if(window.ui.enableTesting){
							//Remove existing
							$('#test-groups').empty();
							var alphabet = "abcdefghijklmnopqrstuvwxyz".split("");
						    $.each(alphabet, function(index,letter) {
								$('#test-groups').append([
									'<label for="test-group-' + letter + '">',
										'<input type="checkbox" class="test-letter-group" id="test-group-' + letter + '" value="' + letter + '" checked>' + letter.toUpperCase(),
									'</label><BR/>'
									].join(''));

								//Show it
								$('.ruin-group-' + letter).show();
						    });

						    //Handle being clicked
						    $('.test-letter-group').on('click',function(e){
						    	var clickedElement = $(e.target);
						    	//Show it
						    	if(e.target.checked){
						    		$('.ruin-group-' + clickedElement.val()).show();

						    	}else{
						    		$('.ruin-group-' + clickedElement.val()).hide();

						    	}

						    });


						    $('#test-groups').show();

						}


			  		},
			  		onMapFailed: function(failure){
			  			showNotice('Map problem encountered: ' + failure.statusText,false);
			  		},

					onObeliskFocus: function onObeliskFocus(e,type,group,number){
						//And "flicker"
						flashObelisk(e,6);
					},

			  		onObeliskSelected: onMapSelection,
			  		onNumberSelected: onMapSelection
			  	});

			  	//Get our site scans and store it
			  	getSiteScans();

		        //Scan Data menu
		        $('#ruin_obelisk_data_close').on('click',function(e){
		        	//Hide the popup
		        	hideScanData();
		        });

		        //Handle closing if clicked outside
		        $(document).on('click',function(event) {
		        	var clickedItem = $(event.target);
		        	//Ignore if this is a number or obelisk.  Those we expect to trigger this event or change the scan displayed
		        	if(clickedItem.hasClass('ruin-number') || clickedItem.hasClass('ruin-obelisk')){
		        		return;
		        	}

					if( !(clickedItem.id == "ruin_obelisk_data" || clickedItem.parents("#ruin_obelisk_data").length) ){
						if($('#ruin_obelisk_data').css('display') === 'block' ){
							hideScanData();
						}
					}

					if($('#notice').css('display') === 'flex' ){
						hideNotice();
					}
				})

		        //Handle escape key
				$(document).keyup(function(e) {
					if (e.keyCode === 27) {
						//Hide any dialogs
						hideInfoBar();
						hideScanData();
					}
				});

				window.flashObelisk = function(obelisk,count){
					if(count <= 0){
						//Done
						$(obelisk).show();
						return;
					}

					//Decrement
					count--;

					if(1 == (count % 2)){
						$(obelisk).fadeOut(200);
					}else{
						$(obelisk).fadeIn(200);
					}

					setTimeout(function(){
						flashObelisk(obelisk,count);
					}, 100);
				}


				function clearScanList(){
					window.ruinsUI.scanListIndex='';
					window.ruinsUI.groupBand='';
					window.ruinsUI.itemBand='';

		        	//Clear everything
	        		$('#scan-list').find("tr:gt(0)").remove();
		        }

		        function addScanListItem(group,number,item1,item2,scan){
					var numDisplay = padNumber(number);

					//New item?
					if(window.ruinsUI.scanListIndex !== group){
						//Reset item band
						window.ruinsUI.itemBand = '';

						//alternate band
						if('' === window.ruinsUI.groupBand){
							window.ruinsUI.groupBand='band';
						}else{
							window.ruinsUI.groupBand='';
						}

						//New group entry
						$('#scan-list').append([
							'<tr id="group-' + group + '" class="obelisk-group groupitem ' + window.ruinsUI.groupBand + '">',
							    '<td colspan="4"><div class="expand_status" alt="expand-collapse icon"/>' + $('<div/>').text(group.toUpperCase()).html() + '</td>',
							'</tr>'
							].join(''));
					}

					//alternate band
					if('' === window.ruinsUI.itemBand){
						window.ruinsUI.itemBand='scanband';
					}else{
						window.ruinsUI.itemBand='';
					}

					$('#scan-list').append([
						'<tr class="obelisk-selection indented obelisk-scans-' + group + ' ' + window.ruinsUI.itemBand + '" id="focus-' + group + '-' + number + '">',
						    '<td>' + $('<div/>').text(group.toUpperCase() + numDisplay).html() + '</td>',
						    '<td>' + $('<div/>').text(item1).html() + '</td>',
						    '<td>' + $('<div/>').text((item2 || ' ')).html() + '</td>',
						    '<td>' + $('<div/>').text(scan).html() + '</td>',
						'</tr>'
						].join(''));

					//Update
					window.ruinsUI.scanListIndex=group;
		        }

		        //Bind our more control
		        $('#info_bar').on('click',function(e){
		        	if($('#info').hasClass('down')) {
			        	showInfoBar();
					}else{
						hideInfoBar();
					}
		        });


				//Added to the table since the elements are dynamically added
			  	$('#scan-list').on('click',function(e){
					var clicked = $(e.target);
			  		var row = $(clicked.closest('tr'));

			  		if(row.hasClass('groupitem')){
			  			//Display all ruins in the given system
			  			if(row[0].id){
			  				//Get the system ID
			  				var idGroup = row[0].id.split('-');

			  				if(2 === idGroup.length){
				  				if(row.hasClass('expanded')){
				  					//collapse
									row.addClass('collapsed');
									row.removeClass('expanded');
									//Hide all items that are "children" of this
			  						$('.obelisk-scans-' + idGroup[1]).hide();
				  				}else{
				  					//expand
				  					row.addClass('expanded');
				  					row.removeClass('collapsed');
				  					//Show all items that are "children" of this
			  						$('.obelisk-scans-' + idGroup[1]).show();
				  				}
			  				}
			  			}

			  		}else if(row.hasClass('obelisk-selection')){
			  			//Display all ruins in the given system
			  			if(row[0].id){
			  				//Get the system ID
			  				var obData = row[0].id.split('-');

			  				if(3 === obData.length){
								//Hide
								hideInfoBar();

								//Focus on the obelisk
								window.ruins.focusOnObelisk(obData[1],obData[2]);
			  				}
			  			}
			  		}


			  	});

				//Handle the zoom controls manually
				$("#zoom-in").on('click', function(){
					window.ruins.zoomIn();
				});

				$("#zoom-out").on('click', function(){
					window.ruins.zoomOut();
				});

				$("#zoom-reset").on('click', function(){
					window.ruins.zoomReset();
				});

				$("#return_to_systems").on('click', function(){
					//Enable navigation back
					$('#return_to_map').show();
					//Show listing
					showSystems();
				});







	      	}



	      	function showMap(){
	  			//Scroll up
	  			$(window).scrollTop(0);

				$('#systems').hide();
				$('#map').show();

				//Change history state
				if(window.currentRuin.ruinId){
					window.history.pushState(null, "Ruin " + window.currentRuin.ruinId, "#GS" + window.currentRuin.ruinId);
				}
	      	}

	      	function showSystems(){
				$('#map').hide();
				$('#systems').show();

				//Change history state
				window.history.pushState(null, "Ruin List", "#");
	      	}

	        function onMapSelection(e,type,group,number){
	        	//Get the scan details for the given obelisk set
	        	var scanData = window.ruins.typeData[type][group][number];

	        	var numDisplay = padNumber(number);

	        	if(scanData){
	        		showScanData(group.toUpperCase() + numDisplay,scanData.items[0],scanData.items[1],scanData.scan);
	        	}else{
	        		showNotice('No scans available for this obelisk',false,1000);
	        	}
	  		}

			function hideScanData(){
				$('#ruin_obelisk_data').hide();
			}

	  		function showScanData(obelisk,object1,object2,data){
	  			//Display
	  			var object1 = object1 || 'None';
	  			var object2 = object2 || 'None';

				//Testing
	  			$('#scan_obelisk').text(obelisk);
				$('#scan_object1').text(object1);
				$('#scan_object1icon').css('background-image','url("images/maps/ruin_' + object1.toLowerCase() + '.png")');

				$('#scan_object2').text(object2);
				$('#scan_object2icon').css('background-image','url("images/maps/ruin_' + object2.toLowerCase() + '.png")');

				$('#scan_result').text(data);
				$('#ruin_obelisk_data').show();
	  		}

	        window.showInfoBar = function(){
	        	$('#info').addClass('up');
				$('#info').removeClass('down');
				//Change chevron
				$('#info_bar .chevron').html('&#x25BE');
	        }

	        window.hideInfoBar = function(){
				$('#info').addClass('down');
				$('#info').removeClass('up');
				//Change chevron
				$('#info_bar .chevron').html('&#x25B4');
	        }

	        function padNumber(number){
				var numDisplay = number;

				if(numDisplay < 9){
					numDisplay = '0' + numDisplay;
				}

				return numDisplay;
	        }

	        function ruinSelected(ruinId){
	        	//Get the associated system info
	        	var ruinSystem = window.ruinsIndex[ruinId];
	        	if(!ruinSystem){
	        		showNotice('Unable to find Ruin Info for ID ' + ruinId,true);
	        		return;
	        	}

	        	var systemId = ruinSystem.systemId;
	        	var type = ruinSystem.ruinType.toLowerCase();

	        	//Start by loading the map type
	        	showNotice('Getting Ruin Info',true);

	        	var ruinRequest = 'https://api.canonn.technology/api/v1/maps/ruininfo/' + encodeURIComponent(parseInt(ruinId));

				$.get(ruinRequest).done(function(ruinInfo) {
						//Add obelisks if missing
						ruinInfo.obelisks = ruinInfo.obelisks || {};

						//Store ruin data in currentRuin;
						window.currentRuin = ruinInfo;

			  			//Update map header info
			  			$('#map_heading h1').text([
			  				window.systems[systemId].systemName,
			  				window.currentRuin.bodyName,
			  				window.currentRuin.coordinates.join(', ')
			  			].join(' | ') + ' (' + window.currentRuin.ruinTypeName + ')');

						//And show
						showNotice('Opening Ruin Map',true);
						window.ruins.setRuinType(type);
					})
					.fail(function(d, textStatus, error){
						showNotice("Getting Ruin Info failed: " + error ,false);
					});
	        }

		  	/* Selection Selection Selection Selection Selection Selection Selection */
		  	/* Selection Selection Selection Selection Selection Selection Selection */
		  	/* Selection Selection Selection Selection Selection Selection Selection */
		  	/* Selection Selection Selection Selection Selection Selection Selection */
		  	function getSiteScans(){
		  		//Show status
        		showNotice('Getting Scan Listing',true);

        		var scanRequest = "https://api.canonn.technology/api/v1/maps/scandata";

				$.get(scanRequest,{ format: "json"}).done(function(scanList) {
		        	hideNotice();

		        	//Add our data
		        	$.each(scanList,function(type,groups){
		        		window.ruins.addType(type,groups);
		        	});
				})
				.fail(function(d, textStatus, error){
					showNotice("Getting Site Scans failed: " + error ,false);
				});

		  	}


	        function getRuinList(){

	        	//Clear everything
        		$('#ruin-list').find("tr:gt(0)").remove();

        		//Show status
        		showNotice('Getting Ruin List',true);

        		var systemList = 'https://api.canonn.technology/api/v1/maps/systemoverview';

				$.get(systemList).done(function(systemList) {
		        	hideNotice();

		        	//Clear existing
		        	window.systems = {};
		        	window.ruinsIndex = {}


	        		//Sort the system list by name
	        		systemList = systemList.sort(function (a, b) {
					    return a.systemName.localeCompare( b.systemName );
					});

					$.each(systemList,function(index,system){
						//Cache system & ruin info

						window.systems[system.systemId]=system;

						var addSite = true;

						var systemId = $('<div/>').text(system.systemId).html();


						//System heading
						var bandClass = '';

						if(addSite){
							if(1 == (index % 2)){
								bandClass='band';
							}

							$('#ruin-list').append([
							'<tr class="ruin_list_system ' + bandClass + '" id="system-' + systemId + '">',
							    '<td colspan="4" class="ruin_list_system_name"><div class="expand_status" alt="expand-collapse icon"/>' + $('<div/>').text(system.systemName).html() + '</td>',
							'</tr>'
							].join(''));
						}

						//Sort by ID
		        		system.ruins = system.ruins.sort(function(a, b) {
						    return a.ruinId - b.ruinId;
						});


		        		$.each(system.ruins,function(rindex,ruin){
		        			//Add the system mapping
		        			window.ruinsIndex[ruin.ruinId] = {
		        				systemId:system.systemId,
		        				ruinType:ruin.ruinTypeName
		        			}
		        			//Add the ruin to the associated Ruins and
							var ruinId = $('<div/>').text(ruin.ruinId).html();
							var ruinType = $('<div/>').text(ruin.ruinTypeName).html();

							if(addSite){


								bandClass = '';
								if(1 == (rindex % 2)){
									bandClass='ruinband';
								}


								$('#ruin-list').append([
								'<tr class="ruin_list_ruin ruin_system_' + systemId + ' ruin_' + ruinId + ' ' + bandClass + '" id="ruin-' + ruinId + '"">',
								    '<td class="indented">' + $('<div/>').text(ruin.bodyName).html() + '</td>',
									'<td>' + 'GS' + ruin.ruinId + '</td>',
								    '<td>' + ruinType + '</td>',
								    '<td>' + $('<div/>').text(ruin.coordinates.join(',')).html() + '</td>',
								'</tr>'
								].join(''));
							}

		        		});



		        	});

					onRuinListReady();
				})
				.fail(function(d, textStatus, error){
					showNotice("Getting Ruin List failed: " + error ,false);
				});

	        }

	        function prepSelectionUI(){
	        	//Map Listing
	        	$('#return_to_map').on('click',function(e){
	        		//Show the map
	        		showMap();
	        	})


	        	//Added to the table since the elements are dynamically added
			  	$('#ruin-list').on('click',function(e){
			  		var clicked = $(e.target);
			  		var row = $(clicked.closest('tr'));

			  		if(row.hasClass('ruin_list_system')){
			  			//Display all ruins in the given system
			  			if(row[0].id){
			  				//Get the system ID
			  				var idSystem = row[0].id.split('-');

			  				if(2 === idSystem.length){
				  				if(row.hasClass('expanded')){
				  					//collapse
									row.addClass('collapsed');
									row.removeClass('expanded');
									//Hide all items that are "children" of this
			  						$('.ruin_system_' + idSystem[1]).hide();
				  				}else{
				  					//expand
				  					row.addClass('expanded');
				  					row.removeClass('collapsed');
				  					//Show all items that are "children" of this
			  						$('.ruin_system_' + idSystem[1]).show();
				  				}


			  				}
			  			}

			  		}else if(row.hasClass('ruin_list_ruin')){
			  			//Display ruin
				  		if(row[0].id){
					  		var idType=row[0].id.split('-');

					  		if(2 === idType.length){
								ruinSelected(idType[1]);
					  		}
				  		}
			  		}
			  	});

				//Filter handling
				$('#ruin-filter').on('keyup',function(e){
					var inputVal = $(e.target).val();
					inputVal = inputVal.toUpperCase();

					//Change?
					if(window.nav.filter !== inputVal){
						//Yes
						window.nav.filter = inputVal;

						//Enumerate the systems
						$.each($('#ruin-list').find("tr.ruin_list_system"),function(group,row){
							//Get the system name
							row = $(row);
							var systemName = row.find('.ruin_list_system_name').text();

							if(window.nav.filter === '' || systemName.indexOf(window.nav.filter) !== -1){
								row.show();
							}else{
								row.hide();
							}



			  			})


					}



				})

			 }

			function showNotice(noticeText,loading,closeAfter){
				if(loading){
					$('#notice').addClass('loading');
				}else{
					$('#notice').removeClass('loading');
				}
				$('#notice').text(noticeText,true).show();

				if(closeAfter){
					setTimeout(function(){
						hideNotice();
					},closeAfter);
				}
			}

			function hideNotice(){
				//Don't hide the notice if there's a delayed notice that will do so
				$('#notice').fadeOut(200);
			}


			function onRuinListReady(){
				processNavPath();
			}

			function processNavPath(){
				//Check for navigation
				var navData = String(window.location.hash || '').replace('#','').split('-');
				var ruinId = String(navData[0] || '').replace('GS','');

				window.nav.obelisk = String(navData[1] || '');

				var ruinId = parseInt(ruinId);

				if(!isNaN(ruinId)){
					ruinSelected(ruinId);
				}

			}


			$( document ).ready(function() {
				//Prep the UI's
			  	prepSelectionUI();
			  	prepMapUI();

			  	//Shared
			  	$('#notice').on('click',function(e){
			  		$('#notice').hide();
			  	})

			  	//Load system
			  	getRuinList();


		      });   //document ready

			$(window).on('hashchange', function() {
			  processNavPath();
			});

	      </script>



</body>
</html>
